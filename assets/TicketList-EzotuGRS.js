import{r as t,u as B,q as $,m as O,k as q,o as I,j as e,a as S,d as z,g as k}from"./index-DivSSI-G.js";import{P as V}from"./plus-DQny7BPa.js";import{S as _}from"./search-DXrw_vMD.js";import{c as G}from"./createLucideIcon-Ce8Hlzfp.js";import{P as T}from"./paperclip-BxaIb1Rn.js";import{E as H}from"./eye-EQRV-fyg.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=G("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function Z(){const[n,C]=t.useState([]),[p,u]=t.useState(!0),[l,F]=t.useState(""),[x,A]=t.useState("Todos"),d=B();t.useEffect(()=>{const s=$(q(S,"chamados"),O("dataAbertura","desc")),a=I(s,r=>{const o=r.docs.map(i=>({id:i.id,...i.data()}));C(o),u(!1)},r=>{console.error("Erro ao buscar chamados:",r),r.code==="permission-denied"&&u(!1)});return()=>a()},[]);const[L,h]=t.useState([]),[P,g]=t.useState([]);t.useEffect(()=>{(async()=>{try{const a=z(S,"sys_settings","general"),r=await k(a);if(r.exists()){const o=r.data();h(o.ticketTypes||[]),g(o.marketplaces||[])}else h(["Devolução","Reembolso","Fraude","Contatar MarketPlace","Contatar Cliente","Interno","Defeito","Prejuízo","Atraso na entrega","Produto errado","Faltou item","Dúvida técnica","Cancelamento"]),g(["Mercado Livre","Amazon","Interno","Shopee","Magalu"])}catch(a){console.error("Error fetching settings:",a)}})()},[]);const[f,R]=t.useState("Todos"),[j,D]=t.useState("Todos"),[m,E]=t.useState("Todos"),c=n.filter(s=>{var b,v,N,w;const a=((b=s.codigo)==null?void 0:b.toLowerCase().includes(l.toLowerCase()))||((v=s.assunto)==null?void 0:v.toLowerCase().includes(l.toLowerCase()))||((N=s.responsavel)==null?void 0:N.toLowerCase().includes(l.toLowerCase()))||((w=s.pedido)==null?void 0:w.toLowerCase().includes(l.toLowerCase())),r=x==="Todos"||s.status===x,o=f==="Todos"||s.tipo===f,i=j==="Todos"||s.marketplace===j,M=m==="Todos"||s.responsavel===m;return a&&r&&o&&i&&M}),y=s=>{switch(s){case"Aberto":return"bg-blue-100 text-blue-800";case"Pendente":return"bg-yellow-100 text-yellow-800";case"Revisão":return"bg-purple-100 text-purple-800";case"Fechado":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Chamados"}),e.jsxs("div",{className:"flex gap-4 mt-1 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"})," Abertos: ",n.filter(s=>s.status==="Aberto").length]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500"})," Pendentes: ",n.filter(s=>s.status==="Pendente").length]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500"})," Em Revisão: ",n.filter(s=>s.status==="Revisão").length]})]})]}),e.jsxs("button",{onClick:()=>d("/chamados/novo"),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",children:[e.jsx(V,{className:"w-5 h-5"}),"Novo Chamado"]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Buscar por código, assunto ou responsável...",value:l,onChange:s=>F(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mt-4 lg:mt-0",children:[e.jsx(J,{className:"text-gray-400 w-5 h-5 hidden sm:block"}),e.jsxs("select",{value:x,onChange:s=>A(s.target.value),className:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-2 focus:ring-blue-500 outline-none text-sm",children:[e.jsx("option",{value:"Todos",children:"Todos os Status"}),e.jsx("option",{value:"Aberto",children:"Aberto"}),e.jsx("option",{value:"Pendente",children:"Pendente"}),e.jsx("option",{value:"Revisão",children:"Revisão"}),e.jsx("option",{value:"Fechado",children:"Fechado"})]}),e.jsxs("select",{onChange:s=>R(s.target.value),className:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-2 focus:ring-blue-500 outline-none text-sm",children:[e.jsx("option",{value:"Todos",children:"Todos os Tipos"}),L.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("select",{onChange:s=>D(s.target.value),className:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-2 focus:ring-blue-500 outline-none text-sm",children:[e.jsx("option",{value:"Todos",children:"Todos os Marketplaces"}),P.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("select",{value:m,onChange:s=>E(s.target.value),className:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-2 focus:ring-blue-500 outline-none text-sm",children:[e.jsx("option",{value:"Todos",children:"Todos os Responsáveis"}),[...new Set(n.map(s=>s.responsavel).filter(Boolean))].sort().map(s=>e.jsx("option",{value:s,children:s},s))]})]})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Código"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assunto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Responsável"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:p?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-10 text-center text-gray-500",children:e.jsxs("div",{className:"flex justify-center items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),"Carregando chamados..."]})})}):c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-10 text-center text-gray-500",children:"Nenhum chamado encontrado."})}):c.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>d(`/chamados/${s.id}`),children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-blue-600",children:s.codigo}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900 font-medium",children:s.assunto}),e.jsx("div",{className:"text-xs text-gray-500",children:s.tipo})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center text-xs font-bold text-gray-600",children:s.responsavel?s.responsavel.charAt(0):"?"}),e.jsx("span",{className:"text-sm text-gray-700",children:s.responsavel||"Não atribuído"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${y(s.status)}`,children:s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.dataAbertura).toLocaleDateString("pt-BR")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[s.anexos&&s.anexos.length>0&&e.jsx(T,{className:"w-4 h-4 text-gray-400",title:"Possui anexos"}),e.jsx("button",{onClick:a=>{a.stopPropagation(),d(`/chamados/${s.id}`)},className:"text-blue-600 hover:text-blue-900",title:"Ver Detalhes",children:e.jsx(H,{className:"w-5 h-5"})})]})})]},s.id))})]})}),e.jsx("div",{className:"md:hidden",children:p?e.jsx("div",{className:"p-10 text-center text-gray-500",children:e.jsxs("div",{className:"flex justify-center items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),"Carregando chamados..."]})}):c.length===0?e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Nenhum chamado encontrado."}):e.jsx("div",{className:"divide-y divide-gray-200",children:c.map(s=>e.jsxs("div",{className:"p-4 hover:bg-gray-50 active:bg-gray-100 cursor-pointer",onClick:()=>d(`/chamados/${s.id}`),children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-blue-600 text-sm block",children:s.codigo}),e.jsxs("h3",{className:"text-gray-900 font-medium flex items-center gap-2",children:[s.assunto,s.anexos&&s.anexos.length>0&&e.jsx(T,{className:"w-4 h-4 text-gray-400"})]})]}),e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${y(s.status)}`,children:s.status})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-xs font-bold text-gray-600",children:s.responsavel?s.responsavel.charAt(0):"?"}),e.jsx("span",{children:s.responsavel||"Não atribuído"})]}),e.jsx("span",{children:new Date(s.dataAbertura).toLocaleDateString("pt-BR")})]})]},s.id))})})]})]})}export{Z as default};
