import{r as l,B as he,q as V,w as X,k as C,o as Z,j as e,a as d,y as z,d as g,Q as o,z as G,C as J,D as me,b as fe}from"./index-YcD-ttPr.js";import{C as be}from"./ConfirmationModal-B558a7Nf.js";import{c as m}from"./createLucideIcon-2-TjKtBl.js";import{P as q}from"./plus-V7gJdWMi.js";import{T as Y}from"./trash-2-DbcUHzGu.js";import{X as ee}from"./x-LSnkibjN.js";import"./alert-triangle--JnSiDDj.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=m("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=m("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=m("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=m("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=m("Layout",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"9",x2:"9",y1:"21",y2:"9",key:"wpwpyp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=m("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=m("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),n=[{id:"iniciar",title:"Iniciar",color:"border-red-500",headerBg:"bg-red-50 text-red-900",dotColor:"bg-red-500"},{id:"andamento",title:"Em Andamento",color:"border-yellow-500",headerBg:"bg-yellow-50 text-yellow-900",dotColor:"bg-yellow-500"},{id:"analisar",title:"Analisar",color:"border-blue-500",headerBg:"bg-blue-50 text-blue-900",dotColor:"bg-blue-500"},{id:"finalizado",title:"Finalizado",color:"border-green-500",headerBg:"bg-green-50 text-green-900",dotColor:"bg-green-500"}],se={baixa:{label:"Baixa",color:"bg-green-100 text-green-800"},media:{label:"Média",color:"bg-blue-100 text-blue-800"},alta:{label:"Alta",color:"bg-orange-100 text-orange-800"},urgente:{label:"Urgente",color:"bg-red-100 text-red-800"}};function Me(){const[f,v]=l.useState([]),[B,A]=l.useState([]),[T,O]=l.useState(!0),[x,re]=l.useState(null),[le,$]=l.useState(!1),[w,P]=l.useState(null),[S,D]=l.useState(""),[_,M]=l.useState(""),[R,E]=l.useState("media"),[L,W]=l.useState(""),[b,Q]=l.useState("board"),[u,oe]=l.useState(0),[j,y]=l.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{},variant:"danger"}),i=l.useRef(null);l.useEffect(()=>{const t=he(fe,s=>{re(s),s||(v([]),A([]),O(!1))});return()=>t()},[]),l.useEffect(()=>{if(!x)return;const t=V(C(d,"kanban_tarefas"),X("userId","==",x.uid)),s=Z(t,p=>{const h=p.docs.map(r=>({id:r.id,...r.data()}));h.sort((r,k)=>new Date(k.dataCriacao)-new Date(r.dataCriacao)),v(h),O(!1)}),a=V(C(d,"kanban_todo"),X("userId","==",x.uid)),c=Z(a,p=>{const h=p.docs.map(r=>({id:r.id,...r.data()}));h.sort((r,k)=>r.concluida===k.concluida?new Date(r.dataCriacao)-new Date(k.dataCriacao):r.concluida?1:-1),A(h)});return()=>{s(),c()}},[x]);const ne=()=>{if(i.current){const t=i.current.scrollLeft,s=i.current.offsetWidth,a=Math.round(t/s);a!==u&&a>=0&&a<n.length&&oe(a)}};l.useEffect(()=>{if(!T&&f.length>0&&i.current&&b==="board"){const t=n.findIndex(s=>f.some(a=>a.status===s.id));t!==-1&&setTimeout(()=>{if(i.current){const s=i.current.offsetWidth,a=t*s;i.current.scrollTo({left:a,behavior:"smooth"})}},300)}},[T,b]);const K=t=>{if(!i.current)return;const s=i.current.offsetWidth;let a=t==="next"?u+1:u-1;a=Math.max(0,Math.min(a,n.length-1)),i.current.scrollTo({left:a*s,behavior:"smooth"})},ie=async t=>{var s;if(t.preventDefault(),!!S.trim())try{let a="iniciar";window.innerWidth<1024&&(a=((s=n[u])==null?void 0:s.id)||"iniciar");const c={titulo:S.trim(),descricao:_.trim(),prioridade:R,status:a,userId:x.uid,dataCriacao:new Date().toISOString(),dataAtualizacao:new Date().toISOString()};w?(await z(g(d,"kanban_tarefas",w.id),{...c,status:w.status}),o.success("Tarefa atualizada!")):(await G(C(d,"kanban_tarefas"),c),o.success("Tarefa criada!")),I()}catch(a){console.error("Error saving task:",a),o.error("Erro ao salvar tarefa")}},de=async t=>{y({isOpen:!0,title:"Excluir Tarefa",message:"Tem certeza que deseja excluir esta tarefa? Esta ação não pode ser desfeita.",variant:"danger",onConfirm:async()=>{try{await J(g(d,"kanban_tarefas",t)),o.success("Tarefa excluída")}catch{o.error("Erro ao excluir")}}})},ce=async()=>{y({isOpen:!0,title:"Limpar Quadro",message:"Tem certeza que deseja limpar todo o quadro? Todas as tarefas serão excluídas permanentemente.",variant:"danger",onConfirm:async()=>{try{const t=me(d);f.forEach(s=>{const a=g(d,"kanban_tarefas",s.id);t.delete(a)}),await t.commit(),o.success("Quadro limpo!")}catch{o.error("Erro ao limpar")}}})},U=async(t,s)=>{const a=n.findIndex(r=>r.id===t.status);if(a===-1)return;let c=s==="next"?a+1:a-1;if(c<0||c>=n.length)return;const p=n[c].id,h=f.map(r=>r.id===t.id?{...r,status:p}:r);v(h);try{await z(g(d,"kanban_tarefas",t.id),{status:p,dataAtualizacao:new Date().toISOString()}),o.success("Tarefa movida!")}catch{o.error("Erro ao mover tarefa"),v(f)}},F=async()=>{if(L.trim())try{await G(C(d,"kanban_todo"),{texto:L.trim(),concluida:!1,userId:x.uid,dataCriacao:new Date().toISOString()}),W("")}catch{o.error("Erro ao adicionar")}},xe=async t=>{try{await z(g(d,"kanban_todo",t.id),{concluida:!t.concluida})}catch{o.error("Erro ao atualizar")}},ue=async t=>{try{await J(g(d,"kanban_todo",t))}catch{o.error("Erro ao excluir")}},H=(t=null)=>{P(t),t?(D(t.titulo),M(t.descricao||""),E(t.prioridade)):(D(""),M(""),E("media")),$(!0)},I=()=>{$(!1),P(null)};if(T)return e.jsx("div",{className:"flex justify-center p-10",children:"Carregando quadro..."});if(!x)return e.jsx("div",{className:"flex justify-center p-10",children:"Faça login para acessar seu Kanban."});const N=t=>f.filter(s=>s.status===t);return e.jsxs("div",{className:"w-full max-w-full min-h-[calc(100vh-130px)] lg:min-h-[calc(100vh-50px)] flex flex-col p-1 lg:p-4 bg-slate-50 relative",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-4 flex-shrink-0",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(te,{className:"w-6 h-6 text-blue-600"}),"Meu Quadro Kanban"]}),e.jsx("div",{className:"flex gap-4 mt-1 text-sm text-gray-500 font-medium flex-wrap",children:n.map(t=>e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${t.dotColor}`}),t.title,": ",e.jsx("span",{className:"text-gray-900",children:N(t.id).length})]},t.id))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>H(),className:"bg-blue-600 hover:bg-blue-700 text-white p-2 sm:px-4 sm:py-2 rounded-lg flex items-center gap-2 shadow-sm transition-all",children:[e.jsx(q,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline",children:"Nova Tarefa"})]}),e.jsxs("button",{onClick:ce,className:"bg-red-100 hover:bg-red-200 text-red-700 p-2 sm:px-4 sm:py-2 rounded-lg flex items-center gap-2 shadow-sm transition-all",children:[e.jsx(Y,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline",children:"Limpar"})]})]})]}),e.jsxs("div",{className:"flex lg:hidden mb-4 bg-white rounded-lg p-1 border border-slate-200 shadow-sm flex-shrink-0",children:[e.jsxs("button",{onClick:()=>Q("board"),className:`flex-1 py-2 rounded-md text-sm font-medium transition-all flex items-center justify-center gap-2 ${b==="board"?"bg-blue-50 text-blue-700 shadow-sm":"text-slate-500 hover:bg-slate-50"}`,children:[e.jsx(te,{className:"w-4 h-4"}),"Quadro"]}),e.jsxs("button",{onClick:()=>Q("todos"),className:`flex-1 py-2 rounded-md text-sm font-medium transition-all flex items-center justify-center gap-2 ${b==="todos"?"bg-blue-50 text-blue-700 shadow-sm":"text-slate-500 hover:bg-slate-50"}`,children:[e.jsx(ve,{className:"w-4 h-4"}),"Tarefas"]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 flex-1 min-h-0 w-full",children:[e.jsxs("div",{className:`flex-1 w-full flex flex-col relative ${b==="board"?"flex":"hidden lg:flex"}`,children:[e.jsxs("div",{className:"sticky top-1/2 z-20 w-full h-0 pointer-events-none",children:[u>0&&e.jsx("button",{onClick:()=>K("prev"),className:"absolute left-2 -translate-y-1/2 pointer-events-auto bg-white/90 backdrop-blur shadow-lg hover:bg-white text-slate-600 hover:text-blue-600 rounded-full p-2.5 transition-all border border-slate-200 hover:scale-105",title:"Deslizar para Esquerda",children:e.jsx(ge,{className:"w-6 h-6"})}),u<n.length-1&&e.jsx("button",{onClick:()=>K("next"),className:"absolute right-2 -translate-y-1/2 pointer-events-auto bg-white/90 backdrop-blur shadow-lg hover:bg-white text-slate-600 hover:text-blue-600 rounded-full p-2.5 transition-all border border-slate-200 hover:scale-105",title:"Deslizar para Direita",children:e.jsx(we,{className:"w-6 h-6"})})]}),e.jsx("div",{ref:i,onScroll:ne,className:"flex flex-1 overflow-x-auto snap-x snap-mandatory scroll-smooth w-full no-scrollbar relative",children:n.map((t,s)=>e.jsxs("div",{className:`
                                    w-full flex-shrink-0 flex flex-col rounded-xl shadow-sm border border-slate-200 bg-white border-t-4 ${t.color} snap-start
                                `,children:[e.jsxs("div",{className:"p-4 border-b border-slate-100 flex justify-between items-center rounded-t-lg bg-slate-50 flex-shrink-0",children:[e.jsx("h3",{className:"font-semibold text-slate-700",children:t.title}),e.jsx("span",{className:`text-xs font-bold px-2 py-0.5 rounded-full ${t.headerBg.replace("text-","bg-").replace("50","100")} ${t.headerBg.replace("bg-","text-").replace("50","800")}`,children:N(t.id).length})]}),e.jsxs("div",{className:"flex-1 p-3 space-y-2 pb-8 lg:pb-3 flex flex-col",children:[N(t.id).map(a=>e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-slate-200 hover:shadow-md transition-all group flex-shrink-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium text-slate-800 line-clamp-2 text-sm",children:a.titulo}),e.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded-full uppercase ${se[a.prioridade].color}`,children:se[a.prioridade].label})]}),a.descricao&&e.jsx("p",{className:"text-xs text-slate-500 mb-2 line-clamp-3",children:a.descricao}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-slate-100 mt-1",children:[e.jsx("span",{className:"text-[10px] text-slate-400",children:new Date(a.dataCriacao).toLocaleDateString("pt-BR")}),e.jsxs("div",{className:"flex gap-1 items-center",children:[e.jsxs("div",{className:"flex gap-1",children:[s>0&&e.jsx("button",{onClick:()=>U(a,"prev"),className:"p-1.5 text-slate-400 hover:text-blue-600 bg-slate-50 rounded-full",title:"Mover para esquerda",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"m15 18-6-6 6-6"})})}),s<n.length-1&&e.jsx("button",{onClick:()=>U(a,"next"),className:"p-1.5 text-slate-400 hover:text-blue-600 bg-slate-50 rounded-full",title:"Mover para direita",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"m9 18 6-6-6-6"})})})]}),e.jsxs("div",{className:"flex gap-1 opacity-100 lg:opacity-0 group-hover:opacity-100 transition-opacity ml-2 border-l pl-2 border-slate-100",children:[e.jsx("button",{onClick:()=>H(a),className:"p-1 text-slate-400 hover:text-blue-600 rounded",title:"Editar",children:e.jsx(ae,{className:"w-3 h-3"})}),e.jsx("button",{onClick:()=>de(a.id),className:"p-1 text-slate-400 hover:text-red-600 rounded",title:"Excluir",children:e.jsx(Y,{className:"w-3 h-3"})})]})]})]})]},a.id)),N(t.id).length===0&&e.jsx("div",{className:"flex flex-1 items-center justify-center text-slate-400 text-sm italic h-full",children:"Nenhuma tarefa"})]})]},t.id))}),e.jsx("div",{className:"absolute bottom-3 left-0 right-0 flex justify-center gap-2 z-10 pointer-events-none",children:n.map((t,s)=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-all shadow-sm ${s===u?`${t.dotColor} w-4`:"bg-slate-300"}`},s))})]}),e.jsxs("div",{className:`w-full lg:w-[304px] bg-white rounded-xl shadow-sm border border-slate-200 flex-col min-h-full ${b==="todos"?"flex":"hidden lg:flex"}`,children:[e.jsx("div",{className:"p-4 border-b border-slate-100 bg-slate-50 rounded-t-xl flex-shrink-0",children:e.jsxs("h3",{className:"font-semibold text-slate-700 flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5 text-green-600"}),"Lista de Tarefas"]})}),e.jsx("div",{className:"p-3 border-b border-slate-100 bg-white flex-shrink-0",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:L,onChange:t=>W(t.target.value),onKeyPress:t=>t.key==="Enter"&&F(),placeholder:"Adicionar nova tarefa...",className:"flex-1 text-sm border border-slate-200 rounded-md px-3 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"}),e.jsx("button",{onClick:F,className:"bg-green-600 hover:bg-green-700 text-white p-2 rounded-md transition-colors",children:e.jsx(q,{className:"w-4 h-4"})})]})}),e.jsxs("div",{className:"flex-1 p-3 space-y-2",children:[B.map(t=>e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border transition-all ${t.concluida?"bg-slate-50 border-slate-100 opacity-70":"bg-white border-slate-200 hover:border-blue-300"}`,children:[e.jsx("button",{onClick:()=>xe(t),className:`w-5 h-5 rounded border flex items-center justify-center transition-colors flex-shrink-0 ${t.concluida?"bg-green-500 border-green-500 text-white":"border-slate-300 hover:border-green-500 text-transparent hover:text-green-200"}`,children:e.jsx(pe,{className:"w-3 h-3"})}),e.jsx("span",{className:`flex-1 text-sm ${t.concluida?"line-through text-slate-400":"text-slate-700"}`,children:t.texto}),e.jsx("button",{onClick:()=>ue(t.id),className:"text-slate-300 hover:text-red-500 transition-colors flex-shrink-0",children:e.jsx(ee,{className:"w-4 h-4"})})]},t.id)),B.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400 text-sm italic",children:"Nenhuma tarefa pendente"})]})]})]}),le&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[w?e.jsx(ae,{className:"w-5 h-5 text-blue-600"}):e.jsx(q,{className:"w-5 h-5 text-blue-600"}),w?"Editar Tarefa":"Nova Tarefa"]}),e.jsx("button",{onClick:I,className:"text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx(ee,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:ie,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Título"}),e.jsx("input",{type:"text",required:!0,maxLength:100,value:S,onChange:t=>D(t.target.value),className:"w-full border border-slate-300 rounded-lg px-3 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:"Ex: Atualizar estoque"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Prioridade"}),e.jsxs("select",{value:R,onChange:t=>E(t.target.value),className:"w-full border border-slate-300 rounded-lg px-3 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"baixa",children:"Baixa"}),e.jsx("option",{value:"media",children:"Média"}),e.jsx("option",{value:"alta",children:"Alta"}),e.jsx("option",{value:"urgente",children:"Urgente"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Descrição"}),e.jsx("textarea",{rows:4,maxLength:500,value:_,onChange:t=>M(t.target.value),className:"w-full border border-slate-300 rounded-lg px-3 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 resize-none",placeholder:"Detalhes da tarefa..."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:I,className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium shadow-sm",children:"Salvar"})]})]})]})}),e.jsx(be,{isOpen:j.isOpen,onClose:()=>y(t=>({...t,isOpen:!1})),onConfirm:()=>{j.onConfirm(),y(t=>({...t,isOpen:!1}))},title:j.title,message:j.message,variant:j.variant})]})}export{Me as default};
