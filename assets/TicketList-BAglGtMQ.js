import{r as t,u as R,q as E,m as M,k as $,o as B,j as e,a as w,d as O,g as q}from"./index-fnibYcRm.js";import{P as I}from"./plus-Bje7WzIk.js";import{S as k}from"./search-kshfpdB6.js";import{c as z}from"./createLucideIcon-8R-GjXmq.js";import{P as C}from"./paperclip-lbqsgTXh.js";import{E as V}from"./eye-y1yJBr5T.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=z("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function W(){const[l,S]=t.useState([]),[m,p]=t.useState(!0),[n,T]=t.useState(""),[x,A]=t.useState("Todos"),d=R();t.useEffect(()=>{const s=E($(w,"chamados"),M("dataAbertura","desc")),a=B(s,r=>{const o=r.docs.map(i=>({id:i.id,...i.data()}));S(o),p(!1)},r=>{console.error("Erro ao buscar chamados:",r),r.code==="permission-denied"&&p(!1)});return()=>a()},[]);const[L,u]=t.useState([]),[P,h]=t.useState([]);t.useEffect(()=>{(async()=>{try{const a=O(w,"sys_settings","general"),r=await q(a);if(r.exists()){const o=r.data();u(o.ticketTypes||[]),h(o.marketplaces||[])}else u(["Devolução","Reembolso","Fraude","Contatar MarketPlace","Contatar Cliente","Interno","Defeito","Prejuízo","Atraso na entrega","Produto errado","Faltou item","Dúvida técnica","Cancelamento"]),h(["Mercado Livre","Amazon","Interno","Shopee","Magalu"])}catch(a){console.error("Error fetching settings:",a)}})()},[]);const[g,F]=t.useState("Todos"),[f,D]=t.useState("Todos"),c=l.filter(s=>{var y,b,v,N;const a=((y=s.codigo)==null?void 0:y.toLowerCase().includes(n.toLowerCase()))||((b=s.assunto)==null?void 0:b.toLowerCase().includes(n.toLowerCase()))||((v=s.responsavel)==null?void 0:v.toLowerCase().includes(n.toLowerCase()))||((N=s.pedido)==null?void 0:N.toLowerCase().includes(n.toLowerCase())),r=x==="Todos"||s.status===x,o=g==="Todos"||s.tipo===g,i=f==="Todos"||s.marketplace===f;return a&&r&&o&&i}),j=s=>{switch(s){case"Aberto":return"bg-blue-100 text-blue-800";case"Pendente":return"bg-yellow-100 text-yellow-800";case"Revisão":return"bg-purple-100 text-purple-800";case"Fechado":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Chamados"}),e.jsxs("div",{className:"flex gap-4 mt-1 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"})," Abertos: ",l.filter(s=>s.status==="Aberto").length]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500"})," Pendentes: ",l.filter(s=>s.status==="Pendente").length]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500"})," Em Revisão: ",l.filter(s=>s.status==="Revisão").length]})]})]}),e.jsxs("button",{onClick:()=>d("/chamados/novo"),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",children:[e.jsx(I,{className:"w-5 h-5"}),"Novo Chamado"]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Buscar por código, assunto ou responsável...",value:n,onChange:s=>T(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(_,{className:"text-gray-400 w-5 h-5 hidden sm:block"}),e.jsxs("select",{value:x,onChange:s=>A(s.target.value),className:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-2 focus:ring-blue-500 outline-none text-sm",children:[e.jsx("option",{value:"Todos",children:"Todos os Status"}),e.jsx("option",{value:"Aberto",children:"Aberto"}),e.jsx("option",{value:"Pendente",children:"Pendente"}),e.jsx("option",{value:"Revisão",children:"Revisão"}),e.jsx("option",{value:"Fechado",children:"Fechado"})]}),e.jsxs("select",{onChange:s=>F(s.target.value),className:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-2 focus:ring-blue-500 outline-none text-sm",children:[e.jsx("option",{value:"Todos",children:"Todos os Tipos"}),L.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("select",{onChange:s=>D(s.target.value),className:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-2 focus:ring-blue-500 outline-none text-sm",children:[e.jsx("option",{value:"Todos",children:"Todos os Marketplaces"}),P.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Código"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assunto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Responsável"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:m?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-10 text-center text-gray-500",children:e.jsxs("div",{className:"flex justify-center items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),"Carregando chamados..."]})})}):c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-10 text-center text-gray-500",children:"Nenhum chamado encontrado."})}):c.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>d(`/chamados/${s.id}`),children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-blue-600",children:s.codigo}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900 font-medium",children:s.assunto}),e.jsx("div",{className:"text-xs text-gray-500",children:s.tipo})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center text-xs font-bold text-gray-600",children:s.responsavel?s.responsavel.charAt(0):"?"}),e.jsx("span",{className:"text-sm text-gray-700",children:s.responsavel||"Não atribuído"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${j(s.status)}`,children:s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.dataAbertura).toLocaleDateString("pt-BR")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[s.anexos&&s.anexos.length>0&&e.jsx(C,{className:"w-4 h-4 text-gray-400",title:"Possui anexos"}),e.jsx("button",{onClick:a=>{a.stopPropagation(),d(`/chamados/${s.id}`)},className:"text-blue-600 hover:text-blue-900",title:"Ver Detalhes",children:e.jsx(V,{className:"w-5 h-5"})})]})})]},s.id))})]})}),e.jsx("div",{className:"md:hidden",children:m?e.jsx("div",{className:"p-10 text-center text-gray-500",children:e.jsxs("div",{className:"flex justify-center items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),"Carregando chamados..."]})}):c.length===0?e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Nenhum chamado encontrado."}):e.jsx("div",{className:"divide-y divide-gray-200",children:c.map(s=>e.jsxs("div",{className:"p-4 hover:bg-gray-50 active:bg-gray-100 cursor-pointer",onClick:()=>d(`/chamados/${s.id}`),children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-blue-600 text-sm block",children:s.codigo}),e.jsxs("h3",{className:"text-gray-900 font-medium flex items-center gap-2",children:[s.assunto,s.anexos&&s.anexos.length>0&&e.jsx(C,{className:"w-4 h-4 text-gray-400"})]})]}),e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${j(s.status)}`,children:s.status})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-xs font-bold text-gray-600",children:s.responsavel?s.responsavel.charAt(0):"?"}),e.jsx("span",{children:s.responsavel||"Não atribuído"})]}),e.jsx("span",{children:new Date(s.dataAbertura).toLocaleDateString("pt-BR")})]})]},s.id))})})]})]})}export{W as default};
