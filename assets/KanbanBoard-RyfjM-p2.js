import{r as l,B as he,q as U,w as F,k as v,o as H,j as e,a as d,y,d as m,Q as i,z as V,C as X,D as fe,b as me}from"./index-BvKRNp9f.js";import{c as w}from"./createLucideIcon-CN9yn7JJ.js";import{P as M}from"./plus-C55U0MUO.js";import{T as Z}from"./trash-2-BY2tmQ-S.js";import{X as G}from"./x-IbEMtz5s.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=w("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=w("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=w("Layout",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"9",x2:"9",y1:"21",y2:"9",key:"wpwpyp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=w("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=w("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),c=[{id:"iniciar",title:"Iniciar",color:"border-red-500",headerBg:"bg-red-50 text-red-900",dotColor:"bg-red-500"},{id:"andamento",title:"Em Andamento",color:"border-yellow-500",headerBg:"bg-yellow-50 text-yellow-900",dotColor:"bg-yellow-500"},{id:"analisar",title:"Analisar",color:"border-blue-500",headerBg:"bg-blue-50 text-blue-900",dotColor:"bg-blue-500"},{id:"finalizado",title:"Finalizado",color:"border-green-500",headerBg:"bg-green-50 text-green-900",dotColor:"bg-green-500"}],ee={baixa:{label:"Baixa",color:"bg-green-100 text-green-800"},media:{label:"Média",color:"bg-blue-100 text-blue-800"},alta:{label:"Alta",color:"bg-orange-100 text-orange-800"},urgente:{label:"Urgente",color:"bg-red-100 text-red-800"}};function ke(){const[x,p]=l.useState([]),[A,B]=l.useState([]),[N,z]=l.useState(!0),[f,te]=l.useState(null),[ae,q]=l.useState(!1),[g,$]=l.useState(null),[k,T]=l.useState(""),[O,C]=l.useState(""),[_,D]=l.useState("media"),[S,P]=l.useState(""),[b,R]=l.useState("board"),[I,se]=l.useState(0),u=l.useRef(null);l.useEffect(()=>{const t=he(me,s=>{te(s),s||(p([]),B([]),z(!1))});return()=>t()},[]),l.useEffect(()=>{if(!f)return;const t=U(v(d,"kanban_tarefas"),F("userId","==",f.uid)),s=H(t,h=>{const o=h.docs.map(r=>({id:r.id,...r.data()}));o.sort((r,j)=>new Date(j.dataCriacao)-new Date(r.dataCriacao)),p(o),z(!1)}),a=U(v(d,"kanban_todo"),F("userId","==",f.uid)),n=H(a,h=>{const o=h.docs.map(r=>({id:r.id,...r.data()}));o.sort((r,j)=>r.concluida===j.concluida?new Date(r.dataCriacao)-new Date(j.dataCriacao):r.concluida?1:-1),B(o)});return()=>{s(),n()}},[f]);const re=()=>{if(u.current){const t=u.current.scrollLeft,s=u.current.offsetWidth,a=Math.round(t/s);a!==I&&a>=0&&a<c.length&&se(a)}};l.useEffect(()=>{if(!N&&x.length>0&&u.current&&b==="board"){const t=c.findIndex(s=>x.some(a=>a.status===s.id));t!==-1&&setTimeout(()=>{if(u.current){const s=u.current.offsetWidth,a=t*s;u.current.scrollTo({left:a,behavior:"smooth"})}},300)}},[N,b]);const le=async t=>{var s;if(t.preventDefault(),!!k.trim())try{let a="iniciar";window.innerWidth<1024&&(a=((s=c[I])==null?void 0:s.id)||"iniciar");const n={titulo:k.trim(),descricao:O.trim(),prioridade:_,status:a,userId:f.uid,dataCriacao:new Date().toISOString(),dataAtualizacao:new Date().toISOString()};g?(await y(m(d,"kanban_tarefas",g.id),{...n,status:g.status}),i.success("Tarefa atualizada!")):(await V(v(d,"kanban_tarefas"),n),i.success("Tarefa criada!")),E()}catch(a){console.error("Error saving task:",a),i.error("Erro ao salvar tarefa")}},oe=async t=>{if(window.confirm("Excluir tarefa?"))try{await X(m(d,"kanban_tarefas",t)),i.success("Tarefa excluída")}catch{i.error("Erro ao excluir")}},ne=async()=>{if(window.confirm("Limpar quadro inteiro?"))try{const t=fe(d);x.forEach(s=>{const a=m(d,"kanban_tarefas",s.id);t.delete(a)}),await t.commit(),i.success("Quadro limpo!")}catch{i.error("Erro ao limpar")}},W=async(t,s)=>{const a=c.findIndex(r=>r.id===t.status);if(a===-1)return;let n=s==="next"?a+1:a-1;if(n<0||n>=c.length)return;const h=c[n].id,o=x.map(r=>r.id===t.id?{...r,status:h}:r);p(o);try{await y(m(d,"kanban_tarefas",t.id),{status:h,dataAtualizacao:new Date().toISOString()})}catch{i.error("Erro ao mover tarefa"),p(x)}},ie=(t,s)=>{t.dataTransfer.setData("taskId",s)},de=t=>{t.preventDefault()},ce=async(t,s)=>{t.preventDefault();const a=t.dataTransfer.getData("taskId"),n=x.find(o=>o.id===a);if(!n||n.status===s)return;const h=x.map(o=>o.id===a?{...o,status:s}:o);p(h);try{await y(m(d,"kanban_tarefas",a),{status:s,dataAtualizacao:new Date().toISOString()}),i.success("Tarefa movida!")}catch{i.error("Erro ao mover tarefa")}},K=async()=>{if(S.trim())try{await V(v(d,"kanban_todo"),{texto:S.trim(),concluida:!1,userId:f.uid,dataCriacao:new Date().toISOString()}),P("")}catch{i.error("Erro ao adicionar")}},xe=async t=>{try{await y(m(d,"kanban_todo",t.id),{concluida:!t.concluida})}catch{i.error("Erro ao atualizar")}},ue=async t=>{try{await X(m(d,"kanban_todo",t))}catch{i.error("Erro ao excluir")}},Q=(t=null)=>{$(t),t?(T(t.titulo),C(t.descricao||""),D(t.prioridade)):(T(""),C(""),D("media")),q(!0)},E=()=>{q(!1),$(null)};if(N)return e.jsx("div",{className:"flex justify-center p-10",children:"Carregando quadro..."});if(!f)return e.jsx("div",{className:"flex justify-center p-10",children:"Faça login para acessar seu Kanban."});const L=t=>x.filter(s=>s.status===t);return e.jsxs("div",{className:"w-full max-w-full h-[calc(100dvh-130px)] lg:h-[calc(100dvh-50px)] flex flex-col p-1 lg:p-4 bg-slate-50 relative overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-4 flex-shrink-0",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(J,{className:"w-6 h-6 text-blue-600"}),"Meu Quadro Kanban"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>Q(),className:"bg-blue-600 hover:bg-blue-700 text-white p-2 sm:px-4 sm:py-2 rounded-lg flex items-center gap-2 shadow-sm transition-all",children:[e.jsx(M,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline",children:"Nova Tarefa"})]}),e.jsxs("button",{onClick:ne,className:"bg-red-100 hover:bg-red-200 text-red-700 p-2 sm:px-4 sm:py-2 rounded-lg flex items-center gap-2 shadow-sm transition-all",children:[e.jsx(Z,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline",children:"Limpar"})]})]})]}),e.jsxs("div",{className:"flex lg:hidden mb-4 bg-white rounded-lg p-1 border border-slate-200 shadow-sm flex-shrink-0",children:[e.jsxs("button",{onClick:()=>R("board"),className:`flex-1 py-2 rounded-md text-sm font-medium transition-all flex items-center justify-center gap-2 ${b==="board"?"bg-blue-50 text-blue-700 shadow-sm":"text-slate-500 hover:bg-slate-50"}`,children:[e.jsx(J,{className:"w-4 h-4"}),"Quadro"]}),e.jsxs("button",{onClick:()=>R("todos"),className:`flex-1 py-2 rounded-md text-sm font-medium transition-all flex items-center justify-center gap-2 ${b==="todos"?"bg-blue-50 text-blue-700 shadow-sm":"text-slate-500 hover:bg-slate-50"}`,children:[e.jsx(ge,{className:"w-4 h-4"}),"Tarefas"]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 flex-1 min-h-0 w-full",children:[e.jsxs("div",{className:`flex-1 w-full overflow-hidden flex flex-col relative ${b==="board"?"flex":"hidden lg:flex"}`,children:[e.jsx("div",{ref:u,onScroll:re,className:"flex lg:gap-4 flex-1 min-h-0 overflow-x-auto snap-x snap-mandatory scroll-smooth pb-0 lg:pb-2 w-full",children:c.map((t,s)=>e.jsxs("div",{className:`
                                    w-full flex-shrink-0 lg:w-[304px] lg:flex-none flex flex-col rounded-xl shadow-sm border border-slate-200 bg-white border-t-4 ${t.color} snap-start h-full
                                `,onDragOver:de,onDrop:a=>ce(a,t.id),children:[e.jsxs("div",{className:"p-4 border-b border-slate-100 flex justify-between items-center rounded-t-lg bg-slate-50 flex-shrink-0",children:[e.jsx("h3",{className:"font-semibold text-slate-700",children:t.title}),e.jsx("span",{className:`text-xs font-bold px-2 py-0.5 rounded-full ${t.headerBg.replace("text-","bg-").replace("50","100")} ${t.headerBg.replace("bg-","text-").replace("50","800")}`,children:L(t.id).length})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-2 pb-8 lg:pb-3 flex flex-col",children:[L(t.id).map(a=>e.jsxs("div",{draggable:!0,onDragStart:n=>ie(n,a.id),className:"bg-white p-4 rounded-lg shadow-sm border border-slate-200 cursor-move hover:shadow-md transition-all group flex-shrink-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium text-slate-800 line-clamp-2 text-sm",children:a.titulo}),e.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded-full uppercase ${ee[a.prioridade].color}`,children:ee[a.prioridade].label})]}),a.descricao&&e.jsx("p",{className:"text-xs text-slate-500 mb-2 line-clamp-3",children:a.descricao}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-slate-100 mt-1",children:[e.jsx("span",{className:"text-[10px] text-slate-400",children:new Date(a.dataCriacao).toLocaleDateString("pt-BR")}),e.jsxs("div",{className:"flex gap-1 items-center",children:[e.jsxs("div",{className:"flex gap-1 lg:hidden",children:[s>0&&e.jsx("button",{onClick:()=>W(a,"prev"),className:"p-1.5 text-slate-400 hover:text-blue-600 bg-slate-50 rounded-full",title:"Mover para esquerda",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"m15 18-6-6 6-6"})})}),s<c.length-1&&e.jsx("button",{onClick:()=>W(a,"next"),className:"p-1.5 text-slate-400 hover:text-blue-600 bg-slate-50 rounded-full",title:"Mover para direita",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"m9 18 6-6-6-6"})})})]}),e.jsxs("div",{className:"flex gap-1 opacity-100 lg:opacity-0 group-hover:opacity-100 transition-opacity ml-2 border-l pl-2 border-slate-100",children:[e.jsx("button",{onClick:()=>Q(a),className:"p-1 text-slate-400 hover:text-blue-600 rounded",title:"Editar",children:e.jsx(Y,{className:"w-3 h-3"})}),e.jsx("button",{onClick:()=>oe(a.id),className:"p-1 text-slate-400 hover:text-red-600 rounded",title:"Excluir",children:e.jsx(Z,{className:"w-3 h-3"})})]})]})]})]},a.id)),L(t.id).length===0&&e.jsx("div",{className:"flex flex-1 items-center justify-center text-slate-400 text-sm italic h-full",children:"Arraste tarefas aqui"})]})]},t.id))}),e.jsx("div",{className:"absolute bottom-3 left-0 right-0 flex justify-center gap-2 lg:hidden z-10 pointer-events-none",children:c.map((t,s)=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-all shadow-sm ${s===I?`${t.dotColor} w-4`:"bg-slate-300"}`},s))})]}),e.jsxs("div",{className:`w-full lg:w-[304px] bg-white rounded-xl shadow-sm border border-slate-200 flex-col h-full ${b==="todos"?"flex":"hidden lg:flex"}`,children:[e.jsx("div",{className:"p-4 border-b border-slate-100 bg-slate-50 rounded-t-xl flex-shrink-0",children:e.jsxs("h3",{className:"font-semibold text-slate-700 flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5 text-green-600"}),"Lista de Tarefas"]})}),e.jsx("div",{className:"p-3 border-b border-slate-100 bg-white flex-shrink-0",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:S,onChange:t=>P(t.target.value),onKeyPress:t=>t.key==="Enter"&&K(),placeholder:"Adicionar nova tarefa...",className:"flex-1 text-sm border border-slate-200 rounded-md px-3 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"}),e.jsx("button",{onClick:K,className:"bg-green-600 hover:bg-green-700 text-white p-2 rounded-md transition-colors",children:e.jsx(M,{className:"w-4 h-4"})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:[A.map(t=>e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border transition-all ${t.concluida?"bg-slate-50 border-slate-100 opacity-70":"bg-white border-slate-200 hover:border-blue-300"}`,children:[e.jsx("button",{onClick:()=>xe(t),className:`w-5 h-5 rounded border flex items-center justify-center transition-colors flex-shrink-0 ${t.concluida?"bg-green-500 border-green-500 text-white":"border-slate-300 hover:border-green-500 text-transparent hover:text-green-200"}`,children:e.jsx(be,{className:"w-3 h-3"})}),e.jsx("span",{className:`flex-1 text-sm ${t.concluida?"line-through text-slate-400":"text-slate-700"}`,children:t.texto}),e.jsx("button",{onClick:()=>ue(t.id),className:"text-slate-300 hover:text-red-500 transition-colors flex-shrink-0",children:e.jsx(G,{className:"w-4 h-4"})})]},t.id)),A.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400 text-sm italic",children:"Nenhuma tarefa pendente"})]})]})]}),ae&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[g?e.jsx(Y,{className:"w-5 h-5 text-blue-600"}):e.jsx(M,{className:"w-5 h-5 text-blue-600"}),g?"Editar Tarefa":"Nova Tarefa"]}),e.jsx("button",{onClick:E,className:"text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx(G,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:le,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Título"}),e.jsx("input",{type:"text",required:!0,maxLength:100,value:k,onChange:t=>T(t.target.value),className:"w-full border border-slate-300 rounded-lg px-3 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:"Ex: Atualizar estoque"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Prioridade"}),e.jsxs("select",{value:_,onChange:t=>D(t.target.value),className:"w-full border border-slate-300 rounded-lg px-3 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"baixa",children:"Baixa"}),e.jsx("option",{value:"media",children:"Média"}),e.jsx("option",{value:"alta",children:"Alta"}),e.jsx("option",{value:"urgente",children:"Urgente"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Descrição"}),e.jsx("textarea",{rows:4,maxLength:500,value:O,onChange:t=>C(t.target.value),className:"w-full border border-slate-300 rounded-lg px-3 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 resize-none",placeholder:"Detalhes da tarefa..."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:E,className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium shadow-sm",children:"Salvar"})]})]})]})})]})}export{ke as default};
