import{h as qe,r as d,l as z,k as _,a as c,Q as i,d as x,g as Te,f as j,j as e,y as O,G as Be,b as Le,C as ie}from"./index-BIQNIXWJ.js";import{L as I,S as $}from"./sweetalert2.esm.all-QMQEJ_kl.js";import{S as Ue,B as $e}from"./settings-DXx9VAgF.js";import{U as Pe}from"./user-CcaI1MId.js";import{c as v}from"./createLucideIcon-BiC_M7d7.js";import{U as Me}from"./users-D-JWS_7q.js";import{C as P}from"./check-circle-D51gh7hl.js";import{T as M}from"./trash-2-PACqYT-W.js";import{P as De}from"./plus-BZ7uuc_C.js";import{D as Fe}from"./download-CKps7rLz.js";import{U as ze}from"./upload-D3yOD6pI.js";import{A as _e}from"./alert-triangle-DYeiMHlu.js";import{S as le}from"./save-DNxXilbW.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=v("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=v("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=v("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=v("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=v("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=v("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=v("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);function sa(){var te;const{userData:r,iderisSettings:f,setIderisSettings:ue}=qe(),[n,w]=d.useState("perfil"),[be,pe]=d.useState(!0),[ge,N]=d.useState(!1),[u,k]=d.useState({ticketTypes:[],marketplaces:[],allowRegistration:!0}),[L,V]=d.useState(""),[p,G]=d.useState("ticketTypes"),[K,q]=d.useState([]),[he,H]=d.useState(!1),[T,J]=d.useState(!1),[C,D]=d.useState(!1),[B,Q]=d.useState(!1),[A,fe]=d.useState("total"),[g,U]=d.useState({chamados:!0,kanban:!0,flex:!0,suporte:!0}),[E,F]=d.useState({enabled:!1,apiKey:""}),[W,X]=d.useState(!1);d.useEffect(()=>{ye()},[]),d.useEffect(()=>{n==="seguranca"&&(r!=null&&r.isAdmin)&&Y(),n==="ideris"&&(r!=null&&r.isAdmin)&&F({enabled:(f==null?void 0:f.enabled)||!1,apiKey:(f==null?void 0:f.apiKey)||""})},[n,r,f]);const Y=async()=>{H(!0);try{const s=(await z(_(c,"usuarios"))).docs.map(t=>({id:t.id,...t.data()}));q(s)}catch(a){console.error("Error fetching users:",a),i.error("Erro ao carregar usuários.")}finally{H(!1)}},S=async(a,s)=>{try{await O(x(c,"usuarios",a),{status:s}),q(t=>t.map(o=>o.id===a?{...o,status:s}:o)),i.success(`Usuário marcado como ${s}.`)}catch(t){console.error("Erro ao atualizar status:",t),i.error("Erro ao atualizar status do usuário.")}},Z=async a=>{try{await Be(Le,a),i.success(`Email de redefinição de senha enviado para ${a}.`)}catch(s){console.error("Erro ao enviar email de redefinição:",s),i.error("Erro ao enviar email de redefinição.")}},ee=async a=>{if((await $.fire({title:"Excluir usuário?",text:"Os dados desta conta serão removidos. Esta ação não afeta o login no Authentication (requer exclusão manual lá caso desejado), mas removerá o acesso ao sistema.",icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, excluir",cancelButtonText:"Cancelar"})).isConfirmed)try{await ie(x(c,"usuarios",a)),q(t=>t.filter(o=>o.id!==a)),i.success("Usuário removido da base de dados.")}catch(t){console.error("Erro ao excluir usuário:",t),i.error("Erro ao excluir usuário.")}},ae=async(a,s)=>{try{await O(x(c,"usuarios",a),{isAdmin:!s}),q(t=>t.map(o=>o.id===a?{...o,isAdmin:!s}:o)),i.success(`Usuário ${s?"rebaixado a Usuário Comum":"promovido a Administrador"}.`)}catch(t){console.error("Erro ao alternar permissões de admin:",t),i.error("Erro ao alterar privilégios de administrador.")}},re=async(a,s,t)=>{const o={...s,[t]:!s[t]};try{await O(x(c,"usuarios",a),{permissions:o}),q(l=>l.map(m=>m.id===a?{...m,permissions:o}:m)),i.success("Permissão atualizada.")}catch(l){console.error("Erro ao atualizar permissão:",l),i.error("Erro ao atualizar permissão.")}},ye=async()=>{N(!0);try{const a=x(c,"sys_settings","general"),s=await Te(a);if(s.exists())k(s.data());else{const t={ticketTypes:["Devolução","Reembolso","Fraude","Contatar MarketPlace","Contatar Cliente","Interno","Defeito","Prejuízo","Atraso na entrega","Produto errado","Faltou item","Dúvida técnica","Cancelamento"],marketplaces:["Mercado Livre","Amazon","Interno","Shopee","Magalu"],allowRegistration:!0};await j(a,t),k(t)}}catch(a){console.error("Error fetching settings:",a),i.error("Erro ao carregar configurações.")}finally{N(!1)}},se=async()=>{if(!L.trim())return;const a=[...u[p]||[],L.trim()],s={...u,[p]:a};try{await j(x(c,"sys_settings","general"),s),k(s),V(""),i.success("Item adicionado com sucesso!")}catch(t){console.error("Error adding item:",t),i.error("Erro ao adicionar item.")}},je=async a=>{const s=u[p].filter(o=>o!==a),t={...u,[p]:s};try{await j(x(c,"sys_settings","general"),t),k(t),i.success("Item removido com sucesso!")}catch(o){console.error("Error deleting item:",o),i.error("Erro ao remover item.")}},ve=async()=>{if(u.ticketTypes.length===0&&u.marketplaces.length===0){i.error("Erro: Dados de configuração não carregados corretamente. Recarregue a página.");return}N(!0);try{await j(x(c,"sys_settings","general"),u,{merge:!0}),i.success("Configurações salvas com sucesso!")}catch(a){console.error("Error saving settings:",a),i.error("Erro ao salvar configurações.")}finally{N(!1)}},we=async()=>{X(!0);try{await j(x(c,"sys_settings","ideris"),E),ue(E),i.success("Configurações do Ideris salvas com sucesso!")}catch(a){console.error("Erro ao salvar configs Ideris:",a),i.error("Erro ao salvar configurações do Ideris.")}finally{X(!1)}},Ne=async()=>{if((await $.fire({title:"Restaurar Padrões?",text:"Isso irá repopular as listas com os valores originais (Devolução, Marketplaces, etc).",icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, restaurar",cancelButtonText:"Cancelar"})).isConfirmed){const s={ticketTypes:["Devolução","Reembolso","Fraude","Contatar MarketPlace","Contatar Cliente","Interno","Defeito","Prejuízo","Atraso na entrega","Produto errado","Faltou item","Dúvida técnica","Cancelamento"],marketplaces:["Mercado Livre","Amazon","Interno","Shopee","Magalu"],allowRegistration:u.allowRegistration};N(!0);try{await j(x(c,"sys_settings","general"),s,{merge:!0}),k(s),i.success("Padrões restaurados com sucesso!")}catch(t){console.error("Error restoring defaults:",t),i.error("Erro ao restaurar padrões.")}finally{N(!1)}}},ke=async()=>{J(!0);try{const a=["chamados","usuarios","notificacoes","erros_suporte","sys_settings","kanban_tarefas","kanban_todo","reports"],s={};for(const b of a){const h=await z(_(c,b));s[b]=h.docs.map(y=>({firebaseId:y.id,...y.data()}))}const t=JSON.stringify(s,null,2),o=new Blob([t],{type:"application/json"}),l=URL.createObjectURL(o),m=document.createElement("a");m.href=l,m.download=`appsi_full_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(l),i.success("Backup local concluído com sucesso!")}catch(a){console.error("Erro no backup:",a),i.error("Erro ao gerar arquivo de backup.")}finally{J(!1)}},Ce=async a=>{var o;const s=(o=a.target.files)==null?void 0:o[0];if(!s)return;if((await $.fire({title:"Restaurar Backup Completo?",text:"Atenção: Isso irá tentar regravar todos os dados do JSON nas coleções originais, podendo sobrescrever registros de mesmo ID. É recomendado limpar dados obsoletos antes, caso queira um espelho exato do arquivo. Continuar?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sim, Restaurar Arquivo",cancelButtonText:"Cancelar"})).isConfirmed){D(!0);try{const l=new FileReader;l.onload=async m=>{try{const b=JSON.parse(m.target.result);let h=0;for(const y of Object.keys(b)){const Se=b[y];for(const Ie of Se){const{firebaseId:oe,...Re}=Ie;oe&&(await j(x(c,y,oe),Re),h++)}}i.success(`Restauração de ${h} registros concluída com sucesso!`)}catch(b){console.error("Erro no parse JSON ou na inserção:",b),i.error("Arquivo JSON inválido ou erro de integração.")}finally{D(!1),a.target.value=""}},l.readAsText(s)}catch(l){console.error("Erro ao ler arquivo:",l),i.error("Erro inesperado na leitura do arquivo local."),D(!1),a.target.value=""}}else a.target.value=""},Ae=async()=>{(await $.fire({title:"ATENÇÃO CRÍTICA: Lixeira Virtual",text:`Você está prestes a excluir registros permanentemente (${A==="total"?"TODOS do sistema":`anteriores a ultima janela de ${A} dias`}). Esta ação é IRREVERSÍVEL. Deseja iniciar a faxina?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Sim, Executar Limpeza",cancelButtonText:"Reconsiderar"})).isConfirmed&&Ee()},Ee=async()=>{Q(!0);let a=0;try{const s=new Date;A!=="total"&&s.setDate(s.getDate()-parseInt(A));const t=l=>A==="total"?!0:l?new Date(l)<s:!1,o=[];g.chamados&&o.push({name:"chamados",dateField:"dataAbertura"}),g.kanban&&(o.push({name:"kanban_tarefas",dateField:"dataCriacao"}),o.push({name:"kanban_todo",dateField:"dataCriacao"})),g.flex&&o.push({name:"reports",dateField:"createdAt"}),g.suporte&&o.push({name:"erros_suporte",dateField:"createdAt"});for(const l of o){const m=await z(_(c,l.name));for(const b of m.docs){const h=b.data(),y=h[l.dateField]||h.dataCriacao||h.createdAt;t(y)&&(await ie(x(c,l.name,b.id)),a++)}}i.success(`Faxina concluída! ${a} registros velhos descartados definitivamente.`)}catch(s){console.error("Erro na limpeza:",s),i.error("Ocorreu um erro ao processar exclusões em massa.")}finally{Q(!1)}};return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[e.jsx(Ue,{className:"w-8 h-8 text-blue-600"}),"Configurações"]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-gray-200 overflow-x-auto",children:[e.jsxs("button",{onClick:()=>w("perfil"),className:`px-6 py-4 font-medium text-sm flex items-center gap-2 transition-colors whitespace-nowrap ${n==="perfil"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(Pe,{className:"w-4 h-4"})," Perfil"]}),e.jsxs("button",{onClick:()=>w("notificacoes"),className:`px-6 py-4 font-medium text-sm flex items-center gap-2 transition-colors ${n==="notificacoes"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[e.jsx($e,{className:"w-4 h-4"})," Notificações"]}),(r==null?void 0:r.isAdmin)&&e.jsxs("button",{onClick:()=>w("seguranca"),className:`px-6 py-4 font-medium text-sm flex items-center gap-2 transition-colors ${n==="seguranca"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(R,{className:"w-4 h-4"})," Segurança"]}),e.jsxs("button",{onClick:()=>w("cadastros"),className:`px-6 py-4 font-medium text-sm flex items-center gap-2 transition-colors ${n==="cadastros"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(de,{className:"w-4 h-4"})," Cadastros Gerais"]}),(r==null?void 0:r.isAdmin)&&e.jsxs("button",{onClick:()=>w("database"),className:`px-6 py-4 font-medium text-sm flex items-center gap-2 transition-colors whitespace-nowrap ${n==="database"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(Oe,{className:"w-4 h-4"})," Banco de Dados"]}),(r==null?void 0:r.isAdmin)&&e.jsxs("button",{onClick:()=>w("ideris"),className:`px-6 py-4 font-medium text-sm flex items-center gap-2 transition-colors whitespace-nowrap ${n==="ideris"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(me,{className:"w-4 h-4"})," Ideris"]})]}),e.jsxs("div",{className:"p-6",children:[n==="perfil"&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-bold text-2xl",children:(te=r==null?void 0:r.nome)==null?void 0:te.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800",children:r==null?void 0:r.nome}),e.jsx("p",{className:"text-gray-500",children:r==null?void 0:r.email}),e.jsx("p",{className:"text-xs text-blue-600 font-medium mt-1",children:"Administrador"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo"}),e.jsx("input",{type:"text",defaultValue:r==null?void 0:r.nome,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",defaultValue:r==null?void 0:r.email,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed"})]})]})]}),n==="notificacoes"&&e.jsx("div",{className:"space-y-6 animate-fade-in",children:e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800",children:"Notificações por Email"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Receba atualizações sobre seus chamados."})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:be,onChange:a=>pe(a.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})}),n==="seguranca"&&(r==null?void 0:r.isAdmin)&&e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"bg-gray-50 p-6 rounded-xl border border-gray-200",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5 text-blue-600"})," Configurações Gerais"]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white border border-gray-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800",children:"Permitir Novos Cadastros"}),e.jsx("p",{className:"text-sm text-gray-500",children:'Habilita ou desabilita a opção de "Cadastre-se" na tela de login.'})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.allowRegistration,onChange:a=>k(s=>({...s,allowRegistration:a.target.checked})),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 bg-gray-50 flex justify-between items-center",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5 text-blue-600"})," Gerenciamento de Usuários"]}),e.jsxs("button",{onClick:Y,className:"text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[e.jsx(xe,{className:"w-4 h-4"})," Atualizar Lista"]})]}),e.jsx("div",{className:"p-4 overflow-x-auto",children:he?e.jsx("div",{className:"flex justify-center p-8",children:e.jsx(I,{className:"w-8 h-8 text-blue-600 animate-spin"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs("table",{className:"w-full text-left min-w-[800px]",children:[e.jsx("thead",{className:"bg-gray-100 border-b-2 border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 uppercase border-r border-white",children:"Usuário"}),e.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 uppercase text-center border-r border-white",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 uppercase text-center border-r border-white",children:"Módulos Permitidos"}),e.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 uppercase text-right",children:"Ações"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:K.map(a=>{var s;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs ${a.email==="admin@admin.com"||a.isAdmin?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:(s=a.nome)==null?void 0:s.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-800 flex items-center gap-1",children:[a.nome,(a.email==="admin@admin.com"||a.isAdmin)&&e.jsx(R,{className:"w-3 h-3 text-purple-600",title:"Administrador"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:a.email})]})]})}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:`text-xs font-bold rounded-full px-3 py-1 ${a.status==="pendente"?"bg-yellow-100 text-yellow-800 border border-yellow-200":a.status==="bloqueado"?"bg-red-100 text-red-800 border border-red-200":"bg-green-100 text-green-800 border border-green-200"}`,children:a.status==="pendente"?"Pendente":a.status==="bloqueado"?"Bloqueado":"Aprovado"})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"flex flex-wrap gap-1.5 justify-center",children:["kanban","estoque","verificacao","suporte","flex"].map(t=>{const o=a.permissions||{kanban:!0,estoque:!0,verificacao:!0,suporte:!0,flex:!0},l=o[t]===!0;return e.jsx("button",{onClick:()=>re(a.id,o,t),disabled:a.email==="admin@admin.com"||a.isAdmin&&a.email!==r.email,className:`text-xs px-2 py-1 rounded-md border transition-colors capitalize ${l?"bg-blue-50 border-blue-200 text-blue-700":"bg-white border-gray-200 text-gray-400 hover:bg-gray-50"} ${(a.email==="admin@admin.com"||a.isAdmin&&a.email!==r.email)&&"opacity-60 cursor-not-allowed"}`,title:`Alternar acesso a ${t}`,children:t},t)})})}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[a.status==="pendente"&&e.jsx("button",{onClick:()=>S(a.id,"aprovado"),disabled:a.email==="admin@admin.com"||a.isAdmin&&a.email!==r.email,className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded-lg disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Aprovar Usuário",children:e.jsx(P,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>ae(a.id,a.isAdmin),disabled:a.email==="admin@admin.com"||a.isAdmin&&a.email!==r.email&&r.email!=="admin@admin.com",className:`p-1.5 rounded-lg disabled:opacity-30 disabled:cursor-not-allowed transition-colors ${a.isAdmin||a.email==="admin@admin.com"?"text-purple-600 bg-purple-50 hover:bg-purple-100":"text-gray-400 hover:text-purple-600 hover:bg-purple-50"}`,title:a.isAdmin||a.email==="admin@admin.com"?"Remover Privilégios de Administrador":"Tornar Administrador",children:e.jsx(R,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>Z(a.email),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Enviar Email de Redefinição de Senha",children:e.jsx(ce,{className:"w-5 h-5"})}),a.status==="bloqueado"&&a.email!=="admin@admin.com"&&e.jsx("button",{onClick:()=>S(a.id,"aprovado"),disabled:a.isAdmin&&a.email!==r.email,className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded-lg disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Desbloquear Usuário",children:e.jsx(P,{className:"w-5 h-5"})}),a.status!=="bloqueado"&&a.email!=="admin@admin.com"&&e.jsx("button",{onClick:()=>S(a.id,"bloqueado"),disabled:a.isAdmin&&a.email!==r.email,className:"p-1.5 text-gray-400 hover:text-orange-600 hover:bg-orange-50 rounded-lg disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Bloquear Usuário",children:e.jsx(ne,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>ee(a.id),disabled:a.email==="admin@admin.com"||a.isAdmin&&a.email!==r.email,className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Excluir Usuário",children:e.jsx(M,{className:"w-5 h-5"})})]})})]},a.id)})})]})}),e.jsx("div",{className:"md:hidden flex flex-col gap-4 pb-2",children:K.map(a=>{var s;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm flex flex-col gap-3",children:[e.jsxs("div",{className:"flex justify-between items-start border-b border-gray-100 pb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm ${a.email==="admin@admin.com"||a.isAdmin?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:(s=a.nome)==null?void 0:s.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-800 flex items-center gap-1 text-sm",children:[a.nome,(a.email==="admin@admin.com"||a.isAdmin)&&e.jsx(R,{className:"w-3 h-3 text-purple-600",title:"Administrador"})]}),e.jsx("p",{className:"text-xs text-gray-500 break-all",children:a.email})]})]}),e.jsx("span",{className:`text-[10px] font-bold rounded-full px-2 py-1 uppercase tracking-wider ${a.status==="pendente"?"bg-yellow-100 text-yellow-800 border border-yellow-200":a.status==="bloqueado"?"bg-red-100 text-red-800 border border-red-200":"bg-green-100 text-green-800 border border-green-200"}`,children:a.status==="pendente"?"Pendente":a.status==="bloqueado"?"Bloqueado":"Aprovado"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wider",children:"Módulos Permitidos"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:["kanban","estoque","verificacao","suporte","flex"].map(t=>{const o=a.permissions||{kanban:!0,estoque:!0,verificacao:!0,suporte:!0,flex:!0},l=o[t]===!0;return e.jsx("button",{onClick:()=>re(a.id,o,t),disabled:a.email==="admin@admin.com"||a.isAdmin&&a.email!==r.email,className:`text-xs px-2 py-1 flex-1 min-w-[30%] justify-center rounded-md border transition-colors capitalize ${l?"bg-blue-50 border-blue-200 text-blue-700":"bg-white border-gray-200 text-gray-400 hover:bg-gray-50"} ${(a.email==="admin@admin.com"||a.isAdmin&&a.email!==r.email)&&"opacity-60 cursor-not-allowed"}`,children:t},t)})})]}),e.jsxs("div",{className:"pt-3 border-t border-gray-100 flex justify-end gap-2 mt-1",children:[a.status==="pendente"&&e.jsx("button",{onClick:()=>S(a.id,"aprovado"),disabled:a.email==="admin@admin.com"||a.isAdmin&&a.email!==r.email,className:"p-2 text-gray-500 hover:text-green-600 bg-gray-50 hover:bg-green-50 rounded-lg disabled:opacity-30 disabled:cursor-not-allowed border border-gray-200 transition-colors",children:e.jsx(P,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ae(a.id,a.isAdmin),disabled:a.email==="admin@admin.com"||a.isAdmin&&a.email!==r.email&&r.email!=="admin@admin.com",className:`p-2 rounded-lg disabled:opacity-30 disabled:cursor-not-allowed border transition-colors ${a.isAdmin||a.email==="admin@admin.com"?"text-purple-600 bg-purple-50 hover:bg-purple-100 border-purple-200":"text-gray-500 bg-gray-50 hover:text-purple-600 hover:bg-purple-50 border-gray-200"}`,children:e.jsx(R,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Z(a.email),className:"p-2 text-gray-500 hover:text-blue-600 bg-gray-50 hover:bg-blue-50 rounded-lg border border-gray-200 transition-colors",children:e.jsx(ce,{className:"w-4 h-4"})}),a.status==="bloqueado"&&a.email!=="admin@admin.com"&&e.jsx("button",{onClick:()=>S(a.id,"aprovado"),disabled:a.isAdmin&&a.email!==r.email,className:"p-2 text-gray-500 hover:text-green-600 bg-gray-50 hover:bg-green-50 rounded-lg disabled:opacity-30 disabled:cursor-not-allowed border border-gray-200 transition-colors",title:"Desbloquear Usuário",children:e.jsx(P,{className:"w-4 h-4"})}),a.status!=="bloqueado"&&a.email!=="admin@admin.com"&&e.jsx("button",{onClick:()=>S(a.id,"bloqueado"),disabled:a.isAdmin&&a.email!==r.email,className:"p-2 text-gray-500 hover:text-orange-600 bg-gray-50 hover:bg-orange-50 rounded-lg disabled:opacity-30 disabled:cursor-not-allowed border border-gray-200 transition-colors",title:"Bloquear Usuário",children:e.jsx(ne,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ee(a.id),disabled:a.email==="admin@admin.com"||a.isAdmin&&a.email!==r.email,className:"p-2 text-gray-500 hover:text-red-600 bg-gray-50 hover:bg-red-50 rounded-lg disabled:opacity-30 disabled:cursor-not-allowed border border-gray-200 transition-colors",children:e.jsx(M,{className:"w-4 h-4"})})]})]},a.id)})})]})})]})]}),n==="cadastros"&&e.jsx("div",{className:"space-y-6 animate-fade-in",children:ge?e.jsx("div",{className:"flex justify-center p-8",children:e.jsx(I,{className:"w-8 h-8 text-blue-600 animate-spin"})}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-1 space-y-2",children:[e.jsx("button",{onClick:()=>G("ticketTypes"),className:`w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors ${p==="ticketTypes"?"bg-blue-50 text-blue-700 border border-blue-200":"bg-white border border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:"Tipos de Chamado"}),e.jsx("button",{onClick:()=>G("marketplaces"),className:`w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors ${p==="marketplaces"?"bg-blue-50 text-blue-700 border border-blue-200":"bg-white border border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:"Marketplaces"})]}),e.jsxs("div",{className:"md:col-span-2 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center border-b pb-2",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:p==="ticketTypes"?"Gerenciar Tipos de Chamado":"Gerenciar Marketplaces"}),e.jsxs("button",{onClick:Ne,className:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1 font-medium bg-blue-50 px-2 py-1 rounded",title:"Restaura os valores sugeridos pelo sistema",children:[e.jsx(xe,{className:"w-3 h-3"})," Restaurar Padrões"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Novo item...",value:L,onChange:a=>V(a.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",onKeyDown:a=>a.key==="Enter"&&se()}),e.jsx("button",{onClick:se,disabled:!L.trim(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(De,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg border border-gray-200 max-h-[400px] overflow-y-auto divide-y divide-gray-100",children:[(u[p]||[]).map((a,s)=>e.jsxs("div",{className:"flex justify-between items-center p-3 hover:bg-white transition-colors",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:a}),e.jsx("button",{onClick:()=>je(a),className:"text-gray-400 hover:text-red-600 p-1.5 rounded-full hover:bg-red-50 transition-colors",title:"Excluir",children:e.jsx(M,{className:"w-4 h-4"})})]},s)),(u[p]||[]).length===0&&e.jsx("div",{className:"p-6 text-center text-gray-400 text-sm",children:"Nenhum item cadastrado."})]})]})]})}),n==="database"&&(r==null?void 0:r.isAdmin)&&e.jsx("div",{className:"space-y-8 animate-fade-in p-2 sm:p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm flex flex-col h-full",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-800 mb-2 flex items-center gap-2",children:[e.jsx(de,{className:"w-5 h-5 text-blue-600"})," Backup e Restauração"]}),e.jsx("p",{className:"text-sm text-gray-500 mb-6 flex-1",children:"Faça o download de uma cópia de segurança local de todos os seus registros do banco de dados (Backup Full) ou recupere o sistema inteiro a partir de um arquivo gerado anteriormente."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:ke,disabled:T||C||B,className:"w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors shadow-sm disabled:opacity-70 disabled:cursor-not-allowed",children:[T?e.jsx(I,{className:"w-5 h-5 animate-spin"}):e.jsx(Fe,{className:"w-5 h-5"}),T?"Gerando Backup...":"Fazer Backup da Nuvem"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:".json",id:"restore-upload",onChange:Ce,disabled:T||C||B,className:"hidden"}),e.jsxs("label",{htmlFor:"restore-upload",className:`w-full bg-white border-2 border-dashed border-gray-300 hover:border-blue-500 hover:bg-blue-50 text-gray-700 px-4 py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors cursor-pointer ${C?"opacity-70 cursor-not-allowed":""}`,children:[C?e.jsx(I,{className:"w-5 h-5 animate-spin text-blue-600"}):e.jsx(ze,{className:"w-5 h-5 text-gray-500"}),C?"Restaurando...":"Restaurar Backup do PC"]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-red-100 shadow-sm flex flex-col h-full bg-gradient-to-b from-white to-red-50/30",children:[e.jsxs("h2",{className:"text-lg font-bold text-red-700 mb-2 flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5"})," Limpeza Inteligente"]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Selecione os módulos e a janela de tempo dos itens que deseja excluir em massa. Ideal para desafogar o sistema de dados antigos ou testes de implantação."}),e.jsxs("div",{className:"space-y-4 flex-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Período Limite (Retenção)"}),e.jsxs("select",{value:A,onChange:a=>fe(a.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 text-sm bg-white",children:[e.jsx("option",{value:"total",children:"Apagamento Total (Ignorar datas)"}),e.jsx("option",{value:"180",children:"Excluir anteriores a 180 dias"}),e.jsx("option",{value:"90",children:"Excluir anteriores a 90 dias"}),e.jsx("option",{value:"30",children:"Excluir anteriores a 30 dias"}),e.jsx("option",{value:"15",children:"Excluir anteriores a 15 dias"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Módulos Alvo"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer p-2 rounded hover:bg-white border transition-colors border-transparent hover:border-gray-200",children:[e.jsx("input",{type:"checkbox",checked:g.chamados,onChange:a=>U(s=>({...s,chamados:a.target.checked})),className:"w-4 h-4 text-red-600 border-gray-300 rounded focus:ring-red-500"}),"Chamados"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer p-2 rounded hover:bg-white border transition-colors border-transparent hover:border-gray-200",children:[e.jsx("input",{type:"checkbox",checked:g.kanban,onChange:a=>U(s=>({...s,kanban:a.target.checked})),className:"w-4 h-4 text-red-600 border-gray-300 rounded focus:ring-red-500"}),"Kanban"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer p-2 rounded hover:bg-white border transition-colors border-transparent hover:border-gray-200",children:[e.jsx("input",{type:"checkbox",checked:g.suporte,onChange:a=>U(s=>({...s,suporte:a.target.checked})),className:"w-4 h-4 text-red-600 border-gray-300 rounded focus:ring-red-500"}),"Suporte"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer p-2 rounded hover:bg-white border transition-colors border-transparent hover:border-gray-200",children:[e.jsx("input",{type:"checkbox",checked:g.flex,onChange:a=>U(s=>({...s,flex:a.target.checked})),className:"w-4 h-4 text-red-600 border-gray-300 rounded focus:ring-red-500"}),"Relatórios Flex"]})]})]})]}),e.jsxs("button",{onClick:Ae,disabled:B||T||C||Object.values(g).every(a=>a===!1),className:"mt-4 w-full bg-red-600 hover:bg-red-700 text-white px-4 py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[B?e.jsx(I,{className:"w-5 h-5 animate-spin"}):e.jsx(_e,{className:"w-5 h-5"}),B?"Limpando Registros...":"Executar Limpeza Definitiva"]})]})]})}),n==="ideris"&&(r==null?void 0:r.isAdmin)&&e.jsx("div",{className:"space-y-6 max-w-2xl animate-fade-in p-6",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-blue-100 shadow-sm bg-gradient-to-br from-white to-blue-50/30",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-2 flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5 text-blue-600"})," API Ideris"]}),e.jsx("p",{className:"text-sm text-gray-500 mb-8 border-b border-gray-100 pb-4",children:"Configure o comportamento dinâmico da integração em todo o sistema. Alterações aplicadas aqui impactam a visão dos módulos de Estoque, Verificação, e a listagem do Flex Imediatamente."}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700 text-sm",children:"Habilitar Integração"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Liga/desliga a consulta ao Ideris no sistema"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:E.enabled,onChange:a=>F({...E,enabled:a.target.checked})}),e.jsx("div",{className:"w-11 h-6 bg-gray-300 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chave da API (Ideris Token)"}),e.jsx("input",{type:"password",value:E.apiKey,onChange:a=>F({...E,apiKey:a.target.value}),placeholder:"Ex: 4d18596794934f39...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-sm transition-shadow bg-gray-50"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Mantenha este campo preenchido com seu Token gerado na plataforma Ideris."})]})]})]})}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-100 flex justify-end",children:[n!=="cadastros"&&n!=="database"&&n!=="ideris"&&e.jsxs("button",{onClick:ve,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium flex items-center gap-2 transition-colors",children:[e.jsx(le,{className:"w-5 h-5"})," Salvar Alterações"]}),n==="ideris"&&e.jsxs("button",{onClick:we,disabled:W,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium flex items-center gap-2 transition-colors disabled:opacity-50",children:[W?e.jsx(I,{className:"w-5 h-5 animate-spin"}):e.jsx(le,{className:"w-5 h-5"}),"Salvar Integração Ideris"]})]})]})]})]})}export{sa as default};
