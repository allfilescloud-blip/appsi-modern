import{r as n,j as e,Q as i}from"./index-CagITQnK.js";import{s as U,u as L}from"./ideris-Dq3DQZVY.js";import{S}from"./search-DYSXYbPs.js";import{X as P}from"./x-Cd0rxfxV.js";import{T as z}from"./trash-2-BzIGsl7z.js";import{S as A}from"./save-D813b30C.js";import"./createLucideIcon-o0tCEqv0.js";function T(){const[o,m]=n.useState(""),[x,h]=n.useState([]),[p,y]=n.useState(!1),[j,v]=n.useState(!1),[N,b]=n.useState(""),[d,g]=n.useState({});n.useEffect(()=>{const t=localStorage.getItem("inventoryLastSearch"),a=localStorage.getItem("inventoryProducts");if(t&&(m(t),b(t)),a)try{h(JSON.parse(a))}catch(s){console.error("Erro ao carregar produtos salvos",s)}},[]);const k=async t=>{if(t.preventDefault(),!o.trim())return;const a=o.split(",").map(s=>s.trim()).filter(Boolean);if(a.length!==0){y(!0);try{const s=await U(a);s.sort((r,l)=>String(r.sku).localeCompare(String(l.sku),void 0,{numeric:!0,sensitivity:"base"})),h(s),b(o),localStorage.setItem("inventoryLastSearch",o),localStorage.setItem("inventoryProducts",JSON.stringify(s)),s.length===0?i.info("Nenhum produto encontrado para os SKUs informados."):i.success(`${s.length} produto(s) encontrado(s).`)}catch(s){i.error("Erro ao buscar SKUs."),console.error(s)}finally{y(!1)}}},C=()=>{h([]),m(""),b(""),g({}),localStorage.removeItem("inventoryLastSearch"),localStorage.removeItem("inventoryProducts"),i.info("Lista limpa.")},w=(t,a)=>{g(s=>({...s,[t]:a}))},I=async()=>{const t=Object.keys(d).filter(r=>{const l=d[r];return l!=null&&String(l).trim()!==""&&!isNaN(Number(l))});if(t.length===0){i.warn("Nenhum item com novo estoque válido para atualizar.");return}v(!0);let a=0,s=0;for(const r of t){const l=parseInt(d[r],10);try{await L(r,l),h(c=>{const u=c.map(f=>f.sku===r?{...f,stockAmount:l}:f);return localStorage.setItem("inventoryProducts",JSON.stringify(u)),u}),g(c=>{const u={...c};return delete u[r],u}),a++}catch(c){console.error(`Falha ao atualizar SKU ${r}:`,c),s++}}a>0&&i.success(`${a} SKU(s) atualizados com sucesso!`),s>0&&i.error(`${s} falha(s) na atualização.`),v(!1)};return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Gestão de Estoque"}),e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("form",{onSubmit:k,className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(S,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",value:o,onChange:t=>m(t.target.value),placeholder:"Digite os SKUs separados por vírgula (ex: 235, 101, 50)",className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"}),o&&e.jsx("button",{type:"button",onClick:()=>m(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 p-1",children:e.jsx(P,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[e.jsxs("button",{type:"submit",disabled:p||!o.trim(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium shadow-sm hover:shadow transition-all flex items-center justify-center gap-2 disabled:opacity-70 disabled:shadow-none",children:[p?e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}):e.jsx(S,{className:"w-5 h-5"}),"Buscar"]}),e.jsxs("button",{type:"button",onClick:C,className:"bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-lg font-medium shadow-sm hover:shadow transition-all flex items-center justify-center gap-2",children:[e.jsx(z,{className:"w-5 h-5"}),"Limpar"]}),e.jsxs("button",{type:"button",onClick:I,disabled:j||x.length===0,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium shadow-sm hover:shadow transition-all flex items-center justify-center gap-2 disabled:opacity-70 disabled:shadow-none",children:[j?e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}):e.jsx(A,{className:"w-5 h-5"}),"Atualizar"]})]})]}),N&&e.jsxs("div",{className:"mt-4 text-center text-sm text-gray-500",children:[e.jsxs("p",{children:["Última pesquisa: ",N]}),!p&&e.jsx("p",{className:"mt-1 text-green-600 font-medium",children:"Consulta concluída."})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:x.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Nenhum produto listado."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-600",children:"SKU"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-600",children:"Produto"}),e.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-600",children:"Estoque Atual"}),e.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-600",children:"Atualizar"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:x.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-blue-700 font-bold font-mono text-base bg-blue-50 px-2 py-1 rounded border border-blue-100",children:t.sku})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-gray-800 font-medium",title:t.title||t.nome,children:t.title||t.nome})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center px-3 py-1 rounded-full bg-blue-50 text-blue-700 font-bold text-sm border border-blue-100",children:t.stockAmount})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("input",{type:"number",min:"0",placeholder:"Novo",value:d[t.sku]||"",onChange:a=>w(t.sku,a.target.value),className:"w-24 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-center transition-all hover:border-blue-400"})})]},t.id))})]})}),e.jsx("div",{className:"md:hidden space-y-4 p-4 min-h-screen bg-transparent",children:x.map(t=>e.jsx("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden transition-all duration-200 hover:shadow-lg",children:e.jsxs("div",{className:"p-5",children:[e.jsx("div",{className:"flex justify-between items-start mb-3",children:e.jsx("span",{className:"text-xl font-bold text-blue-700 bg-blue-50 px-3 py-1.5 rounded-lg border border-blue-100 font-mono",children:t.sku})}),e.jsx("h3",{className:"font-bold text-gray-900 leading-relaxed text-lg mb-4",children:t.title||t.nome}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl border border-gray-200 text-center flex flex-col justify-center",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-1",children:"Atual"}),e.jsx("p",{className:"text-2xl font-black text-gray-800",children:t.stockAmount})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded-xl border border-blue-100 text-center flex flex-col justify-center relative",children:[e.jsx("p",{className:"text-xs text-blue-500 uppercase font-bold tracking-wider mb-1",children:"Novo"}),e.jsx("input",{type:"number",inputMode:"numeric",pattern:"[0-9]*",placeholder:"-",value:d[t.sku]||"",onChange:a=>w(t.sku,a.target.value),className:"w-full text-center text-2xl font-black text-blue-600 outline-none bg-transparent placeholder-blue-300 z-10"})]})]})]})},t.id))})]})})]})}export{T as default};
