import{r as o,u as E,j as e,d as u,a as m,g as p,s as L,b as i,Q as l,c as A,e as q,f as I}from"./index-BIQNIXWJ.js";import{c as x}from"./createLucideIcon-BiC_M7d7.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=x("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=x("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=x("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function U(){const[r,h]=o.useState(!0),[n,y]=o.useState(""),[d,w]=o.useState(""),[c,v]=o.useState(""),[f,g]=o.useState(!1),[j,N]=o.useState(!0),S=E();o.useEffect(()=>{(async()=>{try{const s=u(m,"sys_settings","general"),a=await p(s);a.exists()&&N(a.data().allowRegistration!==!1)}catch(s){console.error("Erro ao buscar configurações:",s)}})()},[]);const k=async t=>{t.preventDefault(),g(!0);try{if(r){const s=await L(i,n,d),a=await p(u(m,"usuarios",s.user.uid));if(a.exists()){const C=a.data(),b=n==="admin@admin.com"?"aprovado":C.status||"aprovado";if(b==="pendente"){await i.signOut(),l.info("Sua conta está aguardando aprovação do administrador.");return}if(b==="bloqueado"){await i.signOut(),l.error("Sua conta foi bloqueada restrita.");return}}l.success("Login realizado com sucesso!"),S("/")}else{const a=(await A(i,n,d)).user;await q(a,{displayName:c}),await I(u(m,"usuarios",a.uid),{nome:c,email:n,status:"pendente",permissions:{kanban:!1,estoque:!1,suporte:!1,flex:!1,verificacao:!1},dataCriacao:new Date().toISOString()}),await i.signOut(),l.success("Conta criada! Aguarde a aprovação do administrador."),h(!0)}}catch(s){console.error(s);let a="Ocorreu um erro.";s.code==="auth/wrong-password"&&(a="Senha incorreta."),s.code==="auth/user-not-found"&&(a="Usuário não encontrado."),s.code==="auth/email-already-in-use"&&(a="Email já está em uso."),s.code==="auth/weak-password"&&(a="A senha deve ter pelo menos 6 caracteres."),l.error(a)}finally{g(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsx("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-xl overflow-hidden",children:e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mb-4 shadow-lg",children:e.jsx(P,{className:"w-8 h-8 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Sistema de Atendimentos"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:r?"Faça login para continuar":"Crie sua conta"})]}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[!r&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo"}),e.jsx("input",{type:"text",required:!0,value:c,onChange:t=>v(t.target.value),className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all outline-none",placeholder:"Seu nome"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",required:!0,value:n,onChange:t=>y(t.target.value),className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all outline-none",placeholder:"seu@email.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Senha"}),e.jsx("input",{type:"password",required:!0,value:d,onChange:t=>w(t.target.value),className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all outline-none",placeholder:"••••••••"})]}),e.jsx("button",{type:"submit",disabled:f,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition-all duration-200 transform hover:scale-[1.02] flex items-center justify-center gap-2 shadow-md disabled:opacity-70 disabled:cursor-not-allowed",children:f?e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):r?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-5 h-5"})," Entrar"]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-5 h-5"})," Criar Conta"]})})]}),j&&e.jsx("div",{className:"mt-8 text-center pt-6 border-t border-gray-100",children:e.jsxs("p",{className:"text-gray-600 text-sm",children:[r?"Não tem uma conta?":"Já possui conta?",e.jsx("button",{onClick:()=>h(!r),className:"ml-2 font-semibold text-blue-600 hover:text-blue-800 transition-colors",children:r?"Cadastre-se":"Fazer Login"})]})})]})})})}export{U as default};
